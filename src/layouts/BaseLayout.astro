---
import '../styles/global.css';
import { getLanguageConfig, getContent, type Lang } from '../lib/i18n';

interface Props {
  lang: Lang;
  title?: string;
}

const { lang = 'en', title = 'Kurt Kühnert — Software Engineer' } = Astro.props;
const langConfig = getLanguageConfig(lang as Lang);
export const prerender = true;
---
<html lang={lang} data-lang={lang}>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#0b0e12" />
    <meta name="description" content="Kurt Kühnert - Software Engineer specializing in geospatial technology, computer graphics, and GPU-based algorithms. Expert in Rust, WebGPU, and terrain rendering." />
    <meta name="author" content="Kurt Kühnert" />
    <meta name="robots" content="index, follow" />
    
    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content={title} />
    <meta property="og:description" content="Software Engineer specializing in geospatial technology and computer graphics" />
    <meta property="og:image" content="/logo.png" />
    <meta property="og:url" content={`https://kuehnert.dev${lang === 'de' ? '/de' : '/en'}`} />
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content="Software Engineer specializing in geospatial technology and computer graphics" />
    <meta name="twitter:image" content="/logo.png" />
    
    <!-- Security -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff" />
    <meta http-equiv="X-Frame-Options" content="DENY" />
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin" />
    
    <link rel="icon" type="image/ico" href="/favicon.ico" sizes="32x32" />
    <link rel="canonical" href={`https://kuehnert.dev${lang === 'de' ? '/de' : '/en'}`} />
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Kurt Kühnert",
      "jobTitle": "Software Engineer",
      "description": "Software Engineer specializing in geospatial technology, computer graphics, and GPU-based algorithms",
      "url": "https://kuehnert.dev",
      "email": "kurt@kuehnert.dev",
      "knowsAbout": ["Rust", "WebGPU", "Computer Graphics", "Geospatial Technology", "GPU Programming"],
      "sameAs": [
        "https://www.linkedin.com/in/kurtkuehnert/",
        "https://github.com/kurtkuehnert",
        "https://www.youtube.com/@kurtkuehnert"
      ]
    }
    </script>
    
    <title>{title}</title>
  </head>
  <body class="min-h-screen flex flex-col">
    <header class="header">
      <div class="container header-content">
        <div class="flex items-center gap-3 sm:gap-4">
          <a href={lang === 'de' ? '/de' : '/en'} aria-label="Home" class="transition-transform duration-300 hover:scale-105">
            <img src="/logo.png" alt="Kurt Kühnert Logo" width="48" height="48" class="sm:w-14 sm:h-14 rounded-full border-2 border-white/20 shadow-lg" />
          </a>
          <a href={lang === 'de' ? '/de' : '/en'} class="header-name hover:opacity-80 transition-opacity duration-300 hidden sm:block">Kurt Kühnert</a>
        </div>
        <nav class="flex items-center gap-2 sm:gap-3">
          <a class="header-icon email" href="mailto:kurt@kuehnert.dev" title="Email" aria-label="Email"></a>
          <a class="header-icon phone hidden xs:flex" href="tel:+49-172-7639811" title="Phone" aria-label="Phone"></a>
          <a class="header-icon linkedin" href="https://www.linkedin.com/in/kurtkuehnert/" target="_blank" rel="noreferrer" title="LinkedIn" aria-label="LinkedIn"></a>
          <a class="header-icon github" href="https://github.com/kurtkuehnert" target="_blank" rel="noreferrer" title="GitHub" aria-label="GitHub"></a>
          <a class="header-icon youtube hidden xs:flex" href="https://www.youtube.com/@kurtkuehnert" target="_blank" rel="noreferrer" title="YouTube" aria-label="YouTube"></a>
          <span class="mx-1 sm:mx-2 text-muted hidden xs:inline">·</span>
          <span class="toggle">
            <a href="/en" aria-current={lang === 'en' ? 'true' : 'false'}>EN</a>
            <a href="/de" aria-current={lang === 'de' ? 'true' : 'false'}>DE</a>
          </span>
        </nav>
      </div>
    </header>
    <main class="flex-1">
      <slot />
    </main>
    <footer class="border-t border-white/10 mt-auto">
      <div class="container flex flex-wrap items-center justify-between gap-2 py-4 text-sm text-muted">
        <p>© {new Date().getFullYear()} Kurt Kühnert</p>
        <p>
          <a class="link" href={lang === 'de' ? '/impressum' : '/en/imprint'}>{lang === 'de' ? 'Impressum' : 'Imprint'}</a>
          ·
          <a class="link" href={lang === 'de' ? '/datenschutz' : '/en/privacy'}>{lang === 'de' ? 'Datenschutzerklärung' : 'Privacy'}</a>
        </p>
      </div>
    </footer>
  </body>
</html>
